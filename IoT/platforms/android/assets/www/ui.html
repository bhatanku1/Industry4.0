<!DOCTYPE HTML>
<meta charset ="UTF-8" />
<html>
<head>
    <title>Home page</title>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="cordova_plugins.js"></script>
    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

</head>

<body>
<div class="bar bar-header bar-dark">
    <h1 class="title">Industry 4.0</h1>
    <a href = "index.html"><button class="button button-clear button-light ion-android-arrow-back"></button></a>
    <!--    <button class="button button-clear button-light"><b>Log Out</b></button> -->
</div>

<div class="tabs-striped tabs-top tabs-background-light tabs-color-dark">
    <div class="tabs">

        <a class="tab-item" onclick="genRandom()">
            <i class="icon ion-home"></i>
            Home
        </a>

        <a class="tab-item" onclick="cache()">
            <i class="icon ion-help"></i>
            Help
        </a>
        <a class="tab-item" href="#">
            <i class="icon ion-gear-a"></i>
            Settings
        </a>
    </div>
</div>

<br>
<br>
<br>
<br>
<br>
<br>


<!--<div id="MyEdit">
    This text will change
</div> -->

<div class="card">
    <div class="item item-divider bar bar-header bar-dark">
        MQTT Connection Information
    </div>
    <div id="hostInfo" class="item item-text-wrap">
        Host:
    </div>
    <div id="portInfo" class="item item-text-wrap">
        Port:
    </div>
    <div id="clientInfo" class="item item-text-wrap">
        Client Id:
    </div>
    <div id="userInfo" class="item item-text-wrap">
        User Name:
    </div>

</div>

<!--<div id="clist" class="list">

    <div id="MyEdit" class="item item-button-right">
            field1
        <button class="button button-positive">
            <i class="icon ion-ios-telephone"></i>
        </button>
    </div>

</div>
-->


<div class="tabs-striped tabs-background-dark tabs-color-light">
    <div class="tabs">
        <a class="tab-item" href="wifi.html">
            <i class="icon ion-wifi"></i>
            Wifi
        </a>
        <a class="tab-item" href="bluetooth_python.html">
            <i class="icon ion-bluetooth"></i>
            Bluetooth
        </a>
        <a class="tab-item" href="opcua.html">
            <i class="icon ion-shuffle"></i>
            OPCUA
        </a>
    </div>
</div>

<!--
<div id="wifi">
    <a>
        <button id = "wifi_ui_btn" class="button button-clear button-large button-light ion-wifi" >
            wifi
        </button>
    </a>
</div>

<div id="btooth">
    <a href = "bluetooth.html">
        <button id = "bluetooth_ui_btn" class="button button-clear button-large button-light ion-bluetooth">
            Bltooth
        </button>
    </a>
</div>

<div id="opcua">
    <a>
        <button id = "opc_ui_btn" class="button button-clear button-large button-light ion-shuffle">
            opcua
        </button>
    </a>
</div>

<div id="help">
    <a>
        <button class="button button-clear button-large button-light ion-help">
            Help
        </button>
    </a>
</div>
-->

<script>
            var randomClient = "";
            var len1 = 0;
			function onDeviceReady() {

				genRandom();
				var db = window.sqlitePlugin.openDatabase({name: "myanother.db"});

  db.transaction(function(tx) {
    //tx.executeSql('DROP TABLE IF EXISTS test_table');
    tx.executeSql('CREATE TABLE IF NOT EXISTS test_table (id integer primary key, host text, port integer, client_Id text, user_Name, pwd text)');

    // demonstrate PRAGMA:
    db.executeSql("pragma table_info (test_table);", [], function(res) {
      console.log("PRAGMA res: " + JSON.stringify(res));
    });

    tx.executeSql("select * from test_table;", [], function(tx, res) {
          alert("inside first tx");
          len1 = res.rows.length;
          alert(len1);
    });


    //tx.executeSql("INSERT INTO test_table (host, port, client_Id, user_Name, pwd) VALUES (?,?,?,?,?)", ["m20.cloudmqtt.com", 11143, randomClient, "user@email.com", "iotiwbiot"], function(tx, res) {
      //alert("insertId: " + res.insertId + " -- probably 1");
      //alert("rowsAffected: " + res.rowsAffected + " -- should be 1");

      db.transaction(function(tx) {

        tx.executeSql("select * from test_table;", [], function(tx, res) {
          var len = res.rows.length;
          //alert(len);
          for (var i=0; i<len; i++){

              var newParagraph = document.createElement('p');
              newParagraph.textContent = res.rows.item(i).host;
              //document.getElementById("clist").appendChild(newParagraph);
              document.getElementById("hostInfo").innerHTML = "Host: " + res.rows.item(i).host
              document.getElementById("portInfo").innerHTML = "Port: " + res.rows.item(i).port
              document.getElementById("clientInfo").innerHTML = "Client Id: " + res.rows.item(i).client_Id
              document.getElementById("userInfo").innerHTML = "User Name: " + res.rows.item(i).user_Name

              //alert( res.rows.item(i).client_Id);
          }
          //alert("res.rows.length: " + res.rows.length + " -- should be 1");
          //alert("res.rows.item(0) " + res.rows.item(0).data + " -- should be 1");
        });
      });

    }, function(e) {
      console.log("ERROR: " + e.message);
    //});  pulaMod_fr_14:58
  });


}


			function cache() {
                document.addEventListener("deviceready", onDeviceReady, false);
                //clickMe();
			}

			function clickMe() {

              document.getElementById("MyEdit").innerHTML = "My new text!"


			}

			function genRandom() {


                //var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
                //for( var i=0; i < 5; i++ )
                //    randomClient += possible.charAt(Math.floor(Math.random() * possible.length));
                randomClient = Math.random().toString(36).substring(7);
                alert(randomClient);

			}
</script>

<body onload="cache()">

</body>

</html>